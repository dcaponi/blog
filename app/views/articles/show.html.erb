<h1 class="text-center"><%= @article.title %></h1>
<h3 class="text-center">Created by: <%= @article.user.email %></h3><br />
<p><%= simple_format(@article.body) %></p>
<% if user_signed_in? %>
  <div class="col-md-12">
    <%= form_for [@article, @comment], remote: true, :html => {class: "form-horizontal", role: "form"} do |f| %>
      <% if @comment.errors.any? %>
        <div class="panel panel-danger col-md-offset-1">
          <div class="panel-heading">
            <h2 class="panel-title"><%= pluralize(@comment.errors.count, "error")%> prevented the comment from being saved</h2>
          </div>
          <div class="panel-body">
            <ul>
              <%= @comment.errors.full_messages.each do |msg| %>
                <li><%= msg %></li>
              <% end %>
            </ul>
          </div>
        </div>
      <% end %>
      <div class="form-group">
        <div class="control-label col-md-2">
          <%= f.label :body, "New Comment" %>
        </div>
        <div class="col-md-10">
          <%= f.text_area :body, rows: 3, class: "form-control", placeholder: "Comment" %>
        </div>
      </div>
      <div class="form-group">
        <div class="col-md-offset-2 col-md 10">
          <%= f.submit class: "btn btn-primary btn-md pull-right" %>
        </div>
      </div>
    <% end %>
  </div>
<% end %>

<div class="col-md-12">
  <header>
    <h3>Comments</h3>
    <% if !user_signed_in? %>
      <em>
        <%= link_to "Sign in", new_user_session_path %> or
        <%= link_to "sign up", new_user_registration_path %> to comment
      </em>
    <% end %>
  </header>
  <hr />
  <div class="col-md-10">
    <% if @article.comments.any? %>
      <div id="messages">
        <% persisted_comments(@comments).each do |comment| %>
          <div class="comment-body">
            <%= comment.body %>
          </div>
          <div class="comment-time">
            <%= time_ago_in_words(comment.created_at) %> ago by <%= comment.user.email %>
          </div>
          <hr />
        <% end %>
      <% else %>
        There are no comments to show
      <% end %>
    </div>
  </div>
</div>
